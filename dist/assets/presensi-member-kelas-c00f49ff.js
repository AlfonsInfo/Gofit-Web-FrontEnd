import{_ as T,d as P,r as p,o as l,c as i,a as t,b as g,F as b,q as S,x as k,t as a,H as j,B as C,u as D,g as m,$ as w,S as v,E as B,l as M,p as I,n as A}from"./index-b7f4b6dc.js";import"https://code.jquery.com/jquery-3.5.1.js";import"https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js";import"https://code.highcharts.com/highcharts.js";const K=P({components:{HomeNavbar:j,BackButton:C},data(){return{router:D(),Presensikelas:m([]),countInit:0,viewMode:!0,selectedPresensi:"",pegawaiPIC:"",hasilTransaksi:m({data:{no_struk:""},jadwal_harian:{jadwal_umum:{kelas:{},instruktur:{}}},member:{nama_member:""}}),transaksiData:m({jenis_transaksi:""}),currentDate:""}},methods:{DataTablesFeatures(){$(document).ready(function(){$("#example thead tr").clone(!0).addClass("filters").appendTo("#example thead"),$("#example").DataTable({orderCellsTop:!0,fixedHeader:!0,initComplete:function(){var e=this.api();e.columns([0,1,2,3,4]).eq(0).each(function(n){var r=$(".filters th").eq($(e.column(n).header()).index()),d=$(r).text();$(r).html('<input type="text" placeholder="'+d+'" />'),$("input",$(".filters th").eq($(e.column(n).header()).index())).off("keyup change").on("change",function(u){$(this).attr("title",$(this).val());var h="({search})";this.selectionStart,e.column(n).search(this.value!=""?h.replace("{search}","((("+this.value+")))"):"",this.value!="",this.value=="").draw()}).on("keyup",function(u){u.stopPropagation(),$(this).trigger("change"),$(this).focus()[0].setSelectionRange(cursorPosition,cursorPosition)})})}})})},async confirmPresence(e){const n=`/presensikelas/${e}`,r=await this.$http.put(n,{status_kehadiran:1});w.success("Berhasil Konfirmasi Presensi"),this.getAllPresence(),console.log(r)},async getAllPresence(e){const n="/presensikelas",r=await this.$http.get(n);this.Presensikelas=r.data.data,console.log(this.Presensikelas),this.countInit==0&&(this.DataTablesFeatures(),this.countInit++,w.success(e))},TableView(){this.viewMode=!this.viewMode,this.getAllPresence},async getNoStruk(e){if(this.selectedPresensi=e,(await v.fire({title:"Apakah Anda yakin melakukan Cetak Struk ? ",showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed){const r=`/cetakstrukkelas/${e.no_booking}`,d=await this.$http.post(r,{id_pegawai:this.pegawaiPIC.id_pegawai});this.hasilTransaksi=d.data.data,this.transaksiData=d.data.transaksi,this.generateStrukAktivasi(),this.getAllPresence(),this.currentDate=this.getCurrentDateTime(),console.log(d),v.fire({title:"Presensi Berhasil!",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}},generateStrukAktivasi(){window.jspPDF=window.jspdf.jsPDF;var e=document.querySelector("#pdfContent");e.style.display="block",e.style.fontSize="5px",e.style.lineHeight="1.2",e.style.margin="0",e.style.padding="0",new B({orientation:"l",unit:"mm",format:["500","200"]}).html(e,{callback:function(r){r.save("file.pdf"),e.style.display="none"},x:10,y:10})},getCurrentDateTime(){var e=new Date,n=e.getDate(),r=e.getMonth()+1,d=e.getFullYear(),u=e.getHours(),h=e.getMinutes(),c=this.addLeadingZero(n)+"/"+this.addLeadingZero(r)+"/"+d,_=this.addLeadingZero(u)+":"+this.addLeadingZero(h),o=c+" "+_;return o},addLeadingZero(e){return(e<10?"0":"")+e},getDataPegawai(){let e=localStorage.getItem("pegawaiData");return JSON.parse(e)}},mounted(){this.getAllPresence("Berhasil Mengambil Data Presensi"),this.pegawaiPIC=this.getDataPegawai()}}),s=e=>(I("data-v-f5567781"),e=e(),A(),e),N={class:"text-dark table-custom mt-5 ms-5 me-5 p-2 d-inline-block"},L={key:0,class:"content bg-white text-dark table-custom m-5 mt-2"},E={class:"container-fluid p-4"},q=s(()=>t("div",{class:"d-flex justify-content-between"},[t("h3",null,"Data Keseluruhan Presensi Kelas")],-1)),V={id:"example",class:"#example table table-striped filters",style:{width:"100%"}},F=s(()=>t("thead",null,[t("tr",null,[t("th",null,"Tanggal Booking"),t("th",null,"ID Member"),t("th",null,"Jadwal"),t("th",null,"Status Kehadiran"),t("th",null,"No Struk"),t("th",null,"Aksi")])],-1)),H={class:"btn btn-primary"},R={key:0},Z={key:1},J={key:0},G=["onClick"],O=["onClick"],U={class:"row"},Y={key:1,class:"content bg-white text-dark table-custom m-5 mt-2"},z={class:"bg light"},Q={width:"600px",id:"pdfContent",style:{display:"none",margin:"500px"},class:"text-dark"},W={width:"600px",class:"p-1"},X={class:"border border-dark"},x=s(()=>t("tr",null,[t("td",{style:{width:"70%"}},[t("strong",null,"Gofit"),t("p",null,"Jl Centralpark No 10 Yogyakarta")])],-1)),tt={style:{width:"80%"}},et={key:0},st=s(()=>t("strong",null,"STRUK PRESENSI KELAS",-1)),at=[st],nt={key:1},lt=s(()=>t("strong",null,"STRUK PRESENSI KELAS PAKET",-1)),it=[lt],ot=s(()=>t("td",null,"No Struk",-1)),rt=s(()=>t("td",null,":",-1)),dt=s(()=>t("td",null,"Tanggal",-1)),ut=s(()=>t("td",null,":",-1)),ht={key:0},ct={style:{width:"80%"}},_t=s(()=>t("td",null,[t("strong",null,"Member")],-1)),kt=s(()=>t("td",null,":",-1)),mt=s(()=>t("td",null,"Kelas",-1)),pt=s(()=>t("td",null,":",-1)),gt=s(()=>t("td",null,"Instruktur",-1)),bt=s(()=>t("td",null,":",-1)),wt=s(()=>t("td",null,"Sisa Deposit",-1)),vt=s(()=>t("td",null,":",-1)),ft=s(()=>t("td",null,"Berlaku sampai dengan",-1)),yt=s(()=>t("td",null,":",-1)),Tt={key:1},Pt={style:{width:"80%"}},St=s(()=>t("td",null,[t("strong",null,"Member")],-1)),jt=s(()=>t("td",null,":",-1)),Ct=s(()=>t("td",null,"Kelas",-1)),Dt=s(()=>t("td",null,":",-1)),$t=s(()=>t("td",null,"Instruktur",-1)),Bt=s(()=>t("td",null,":",-1)),Mt=s(()=>t("td",null,"Tarif",-1)),It=s(()=>t("td",null,":",-1)),At=s(()=>t("td",null,"Sisa deposit",-1)),Kt=s(()=>t("td",null,":",-1)),Nt=s(()=>t("tr",null,[t("td")],-1));function Lt(e,n,r,d,u,h){const c=p("home-navbar"),_=p("back-button");return l(),i(b,null,[t("header",null,[g(c,{message:"Gofit - Olah Presensi Kelas"})]),t("main",null,[t("div",N,[t("div",null,[e.viewMode?(l(),i("button",{key:0,class:"btn btn-success mb-3",onClick:n[0]||(n[0]=o=>e.viewMode=!e.viewMode)},"Card View")):(l(),i("button",{key:1,class:"btn btn-success mb-3",onClick:n[1]||(n[1]=(...o)=>e.TableView&&e.TableView(...o))},"Table View"))])]),e.viewMode?(l(),i("div",L,[t("div",E,[q,t("table",V,[F,t("tbody",null,[(l(!0),i(b,null,S(e.Presensikelas,(o,f)=>(l(),i("tr",{key:f},[t("td",null,a(o.tanggal_booking),1),t("td",null,a(o.id_member),1),t("td",null,[t("button",H,"Detail "+a(o.jadwal_harian.tanggal_jadwal_harian),1)]),t("td",null,a(o.status_kehadiran==0?"Belum Hadir":"Telah Dikonfirmasi"),1),t("td",null,[o.no_struk?(l(),i("div",R,a(o.no_struk),1)):(l(),i("div",Z,[o.status_kehadiran==0?(l(),i("div",J,"Belum Cetak Struk")):(l(),i("div",{key:1,onClick:M(y=>e.getNoStruk(o),["prevent"]),class:"btn btn-warning"},"Cetak Struk",8,G))]))]),t("td",null,[o.status_kehadiran==0?(l(),i("button",{key:0,onClick:y=>e.confirmPresence(o.no_booking),class:"btn btn-success"},"Presensi",8,O)):k("",!0)])]))),128))])]),t("div",U,[g(_,{class:"col-md-3",className:"btn btn-dark"})])])])):(l(),i("div",Y," Ambil tabel jadwal harian dari sesudah hari ini "))]),t("div",z,[t("div",Q,[t("div",W,[t("table",X,[x,t("tr",null,[t("td",null,[t("table",null,[t("tr",tt,[e.transaksiData.jenis_transaksi=="transaksi-presensi-kelas"?(l(),i("td",et,at)):k("",!0),e.transaksiData.jenis_transaksi=="transaksi-presensi-kelas-paket"?(l(),i("td",nt,it)):k("",!0)]),t("tr",null,[ot,rt,t("td",null,a(e.hasilTransaksi.no_struk),1)]),t("tr",null,[dt,ut,t("td",null,a(e.currentDate),1)])])])]),t("tr",null,[t("td",null,[e.transaksiData.jenis_transaksi=="transaksi-presensi-kelas-paket"?(l(),i("table",ht,[t("tr",ct,[_t,kt,t("td",null,a(e.selectedPresensi.id_member)+" / "+a(e.hasilTransaksi.member.nama_member),1)]),t("tr",null,[mt,pt,t("td",null,a(e.hasilTransaksi.jadwal_harian.jadwal_umum.kelas.jenis_kelas),1)]),t("tr",null,[gt,bt,t("td",null,a(e.hasilTransaksi.jadwal_harian.jadwal_umum.instruktur.nama_instruktur),1)]),t("tr",null,[wt,vt,t("td",null,a(e.hasilTransaksi.member.total_deposit_paket),1)]),t("tr",null,[ft,yt,t("td",null,a(e.hasilTransaksi.member.tgl_kadeluarsa_paket),1)])])):(l(),i("table",Tt,[t("tr",Pt,[St,jt,t("td",null,a(e.selectedPresensi.id_member)+" / "+a(e.hasilTransaksi.member.nama_member),1)]),t("tr",null,[Ct,Dt,t("td",null,a(e.hasilTransaksi.jadwal_harian.jadwal_umum.kelas.jenis_kelas),1)]),t("tr",null,[$t,Bt,t("td",null,a(e.hasilTransaksi.jadwal_harian.jadwal_umum.instruktur.nama_instruktur),1)]),t("tr",null,[Mt,It,t("td",null,a(e.hasilTransaksi.jadwal_harian.jadwal_umum.kelas.harga_kelas),1)]),t("tr",null,[At,Kt,t("td",null,a(parseInt(e.hasilTransaksi.member.total_deposit_uang)-parseInt(e.hasilTransaksi.jadwal_harian.jadwal_umum.kelas.harga_kelas)),1)])]))])]),Nt])])])])],64)}const Jt=T(K,[["render",Lt],["__scopeId","data-v-f5567781"]]);export{Jt as default};
