import{_ as P,d as T,r as k,o as l,c as o,a as e,b,F as f,q as C,x as h,t as r,k as S,H as B,B as D,u as x,g,S as m,$ as y,E as M,l as N,p as A,n as I}from"./index-b7f4b6dc.js";import"https://code.jquery.com/jquery-3.5.1.js";import"https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js";import"https://code.highcharts.com/highcharts.js";const q=T({components:{HomeNavbar:B,BackButton:D},data(){return{router:x(),Presensigym:g([]),countInit:0,showTable:!0,pegawaiPIC:"",selectedPresensi:{},hasilTransaksi:g({data:{no_struk:""},sesi:{waktu_mulai:"",waktu_selesai:""},member:{nama_member:""}}),currentDate:"",newMember:g({})}},methods:{DataTablesFeatures(){$(document).ready(function(){$("#example thead tr").clone(!0).addClass("filters").appendTo("#example thead"),$("#example").DataTable({orderCellsTop:!0,fixedHeader:!0,initComplete:function(){var t=this.api();t.columns([0,1,2,3,4]).eq(0).each(function(n){var s=$(".filters th").eq($(t.column(n).header()).index()),d=$(s).text();$(s).html('<input type="text" placeholder="'+d+'" />'),$("input",$(".filters th").eq($(t.column(n).header()).index())).off("keyup change").on("change",function(u){$(this).attr("title",$(this).val());var c="({search})";this.selectionStart,t.column(n).search(this.value!=""?c.replace("{search}","((("+this.value+")))"):"",this.value!="",this.value=="").draw()}).on("keyup",function(u){u.stopPropagation(),$(this).trigger("change"),$(this).focus()[0].setSelectionRange(cursorPosition,cursorPosition)})})}})})},getDataPegawai(){let t=localStorage.getItem("pegawaiData");return JSON.parse(t)},async confirmPresence(t){if((await m.fire({title:"Apakah Anda yakin melakukan konfirmasi kehadiran ? ",showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed){const s=`http://localhost:8000/api/presensigym/${t}`,d=await this.$http.put(s,{status_kehadiran:1});y.success("Berhasil Konfirmasi Presensi"),this.getAllPresence(),console.log(d),m.fire({title:"Presensi Berhasil!",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}},async getNoStruk(t){if(this.selectedPresensi=t,(await m.fire({title:"Apakah Anda yakin melakukan Cetak Struk ? ",showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed){const s=`/cetakstrukgym/${t.no_booking}`,d=await this.$http.post(s,{id_pegawai:this.pegawaiPIC.id_pegawai});this.hasilTransaksi=d.data.data,console.log("hasil",this.hasilTransaksi),this.requestNewestMember(t.id_member),this.generateStrukAktivasi(),this.getAllPresence(),this.currentDate=this.getCurrentDateTime(),console.log(d),m.fire({title:"Presensi Berhasil!",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}},async getAllPresence(t){const n="http://localhost:8000/api/presensigym",s=await this.$http.get(n);this.Presensigym=s.data.data,console.log(this.Presensigym),this.countInit==0&&(this.DataTablesFeatures(),this.countInit++,y.success(t))},generateStrukAktivasi(){window.jspPDF=window.jspdf.jsPDF;var t=document.querySelector("#pdfContent");t.style.display="block",t.style.fontSize="5px",t.style.lineHeight="1.2",t.style.margin="0",t.style.padding="0",new M({orientation:"l",unit:"mm",format:["300","100"]}).html(t,{callback:function(s){s.save("file.pdf"),t.style.display="none"},x:10,y:10})},getCurrentDateTime(){var t=new Date,n=t.getDate(),s=t.getMonth()+1,d=t.getFullYear(),u=t.getHours(),c=t.getMinutes(),_=this.addLeadingZero(n)+"/"+this.addLeadingZero(s)+"/"+d,p=this.addLeadingZero(u)+":"+this.addLeadingZero(c),i=_+" "+p;return i},addLeadingZero(t){return(t<10?"0":"")+t},async requestNewestMember(t){console.log(t);const n=`/member/${t}`,s=await this.$http.get(n);this.newMember=s.data.data[0],console.log(this.newMember)}},mounted(){this.getAllPresence("Berhasil Mengambil Data Presensi"),this.pegawaiPIC=this.getDataPegawai()}}),a=t=>(A("data-v-5fd7bc50"),t=t(),I(),t),L=a(()=>e("div",{class:"text-dark table-custom mt-5 ms-5 me-5 p-2 d-inline-block"},null,-1)),G={class:"content bg-white text-dark table-custom m-5 mt-2"},H={key:0,class:"container-fluid p-4"},F=a(()=>e("h3",null,"Tabel Presensi member Gym",-1)),j={id:"example",class:"#example table table-striped filters",style:{width:"100%"}},Z=a(()=>e("thead",null,[e("tr",null,[e("th",null,"Tanggal Booking"),e("th",null,"Tanggal Sesi Gym"),e("th",null,"Status Kehadiran"),e("th",null,"ID Member"),e("th",null,"No Struk"),e("th",null,"Aksi")])],-1)),E={key:0},R={key:1},V={key:0},K={key:1},Y={key:0},J=["onClick"],O=["onClick"],z={class:"row"},U={class:"bg light"},W={width:"600px",id:"pdfContent",style:{display:"none",margin:"500px"},class:"text-dark"},Q={width:"600px",class:"p-1"},X={class:"border border-dark"},ee=a(()=>e("tr",null,[e("td",{style:{width:"70%"}},[e("strong",null,"Gofit"),e("p",null,"Jl Centralpark No 10 Yogyakarta")])],-1)),te=a(()=>e("tr",{style:{width:"80%"}},[e("td",null,[e("strong",null,"STRUK PRESENSI GYM")])],-1)),se=a(()=>e("td",null,"No Struk",-1)),ae=a(()=>e("td",null,":",-1)),ne=a(()=>e("td",null,"Tanggal",-1)),ie=a(()=>e("td",null,":",-1)),le={style:{width:"80%"}},oe=a(()=>e("td",null,[e("strong",null,"Member")],-1)),re=a(()=>e("td",null,":",-1)),de=a(()=>e("td",null,"Slot Waktu",-1)),ue=a(()=>e("td",null,":",-1)),ce=a(()=>e("tr",null,[e("td")],-1));function he(t,n,s,d,u,c){const _=k("home-navbar"),p=k("back-button");return l(),o(f,null,[e("header",null,[b(_,{message:"Gofit - Olah Presensi Gym Member"})]),e("main",null,[L,e("div",G,[t.showTable?(l(),o("div",H,[F,e("table",j,[Z,e("tbody",null,[(l(!0),o(f,null,C(t.Presensigym,(i,v)=>(l(),o("tr",{key:v},[e("td",null,r(i.tanggal_booking),1),e("td",null,r(i.tanggal_sesi_gym),1),e("td",null,[i.status_kehadiran==0?(l(),o("div",E,"Tidak Hadir")):h("",!0),i.status_kehadiran==1?(l(),o("div",R,"Hadir")):h("",!0)]),e("td",null,r(i.id_member),1),e("td",null,[i.no_struk?(l(),o("div",V,r(i.no_struk),1)):(l(),o("div",K,[i.status_kehadiran==0?(l(),o("div",Y,"Belum Cetak Struk")):(l(),o("div",{key:1,onClick:N(w=>t.getNoStruk(i),["prevent"]),class:"btn btn-warning"},"Cetak Struk",8,J))]))]),e("td",null,[i.status_kehadiran==0?(l(),o("button",{key:0,onClick:w=>t.confirmPresence(i.no_booking),class:"btn btn-success"},"Presensi",8,O)):h("",!0)])]))),128))])]),e("div",z,[b(p,{class:"col-md-3",className:"btn btn-dark"})])])):h("",!0)])]),e("div",U,[e("div",W,[e("div",Q,[e("table",X,[ee,e("tr",null,[e("td",null,[e("table",null,[te,e("tr",null,[se,ae,e("td",null,r(t.hasilTransaksi.no_struk),1)]),e("tr",null,[ne,ie,e("td",null,r(t.currentDate),1)])])])]),S(),e("tr",null,[e("td",null,[e("table",null,[e("tr",le,[oe,re,e("td",null,r(t.selectedPresensi.id_member)+" / "+r(t.hasilTransaksi.member.nama_member),1)]),e("tr",null,[de,ue,e("td",null,r(t.hasilTransaksi.sesi.waktu_mulai)+" - "+r(t.hasilTransaksi.sesi.waktu_selesai),1)])])])]),ce])])])])],64)}const ye=P(q,[["render",he],["__scopeId","data-v-5fd7bc50"]]);export{ye as default};
