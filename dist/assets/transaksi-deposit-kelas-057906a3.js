import{_ as w,d as K,r as f,o as l,c as r,a,b as T,F as p,q as c,l as D,w as d,v as u,z as y,y as $,t as n,x as k,H as M,B,h as S,g as U,S as h,$ as g,E as P,p as j,n as I,k as N}from"./index-b7f4b6dc.js";import"https://code.jquery.com/jquery-3.5.1.js";import"https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js";import"https://code.highcharts.com/highcharts.js";const C=K({components:{HomeNavbar:M,BackButton:B},data(){return{FormTransactionUang:S({id_pegawai:this.getDataPegawai().id_pegawai,id_member:"",NoStruk:"",id_kelas:U({id_kelas:""}),nominal_deposit_kelas:0,nominal_deposit_kelas_send:0,nominal_uang:0,id_promo:""}),promos:null,allMember:null,allKelas:null,hasilTransaksi:U({transaksi_deposit_paket:{no_struk:""},transaksi_member:{},member:{},kelas:{}}),selectedPromo:null,selectedKelas:null,PromoMessage:"Dapatkan Promo Menarik!!!",satuanKelasMessage:"",summaryMessage:"Ringkasan Transaksi : - ",totalClasses:0}},methods:{async submitForm(){if((await h.fire({title:"Apakah Anda yakin ingin melakukan transaksi ini?",showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed)try{console.log(this.FormTransactionUang);const t="/transaksidepositpaket",i=await this.$http.post(t,this.FormTransactionUang);this.hasilTransaksi=i.data.data,console.log(i.data.data),g.success(i.data.message),this.generateStrukDepositPaket(),h.fire({title:"Transaksi Berhasil!",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}catch(t){console.log(t.response.data.message),h.fire({icon:"warning",title:"Mohon Maaf",text:t.response.data.message,timer:2e3,timerProgressBar:!0,showConfirmButton:!1}),g.warning("Transaksi Gagal, Cek Data Transaksi !!")}},generateStrukDepositPaket(){window.jspPDF=window.jspdf.jsPDF;var s=document.querySelector("#pdfContent2");s.style.display="block",s.style.fontSize="5px",s.style.lineHeight="1.2",s.style.margin="0",s.style.padding="0",new P({orientation:"l",unit:"mm",format:["300","100"]}).html(s,{callback:function(i){i.save("file.pdf"),s.style.display="none"},x:10,y:10})},async generateTransactionData(){const t=(await this.$http.get("/transaksiaktivasi")).data+1,i=new Date,_=i.getFullYear().toString().substr(-2),b=("0"+(i.getMonth()+1)).slice(-2);this.FormTransactionUang.NoStruk=_+"."+b+"."+t},async getAllMember(){const s="/member",t=await this.$http.get(s);this.allMember=t.data.data,console.log(this.allMember)},async getAllKelas(){const s="/kelas",t=await this.$http.get(s);this.allKelas=t.data.kelas},getKelas(){let s=this.allKelas;this.selectedKelas=s.filter(t=>t.id_kelas==this.FormTransactionUang.id_kelas)[0]},updateAfterInputKelas(){this.getKelas();let{jenis_kelas:s,harga_kelas:t}=this.selectedKelas;this.satuanKelasMessage=`Harga Satuan Kelas ${s}, Rp = ${t} / 1 x pertemuan`},updateAfterInputQuantity(){this.promo=this.availablePromo(),this.promo!=null?(this.FormTransactionUang.id_promo=this.promo.id_promo,this.FormTransactionUang.nominal_deposit_kelas_send=this.FormTransactionUang.nominal_deposit_kelas+this.promo.bonus_promo,this.summaryMessage=`Ringkasan Transaksi : Pembelian Kelas ${this.selectedKelas.jenis_kelas} (masa berlaku ${this.promo.masa_berlaku} bulan) dengan 
        deposit ${this.FormTransactionUang.nominal_deposit_kelas_send}(bayar ${this.FormTransactionUang.nominal_deposit_kelas} gratis ${this.promo.bonus_promo}), 
        biaya : ${this.FormTransactionUang.nominal_deposit_kelas} x Rp ${this.selectedKelas.harga_kelas} = Rp ${this.FormTransactionUang.nominal_uang}
        Transaksi dilakukan oleh member : ${this.FormTransactionUang.id_member}. `):(this.FormTransactionUang.id_promo=0,this.FormTransactionUang.nominal_deposit_kelas_send=this.FormTransactionUang.nominal_deposit_kelas,this.summaryMessage=`Ringkasan Transaksi : Pembelian Kelas ${this.selectedKelas.jenis_kelas} (masa berlaku 1 bulan) dengan
        deposit ${this.FormTransactionUang.nominal_deposit_kelas_send} biaya : ${this.FormTransactionUang.nominal_deposit_kelas} x Rp ${this.selectedKelas.harga_kelas} = Rp ${this.FormTransactionUang.nominal_uang}
        Transaksi dilakukan oleh member : ${this.FormTransactionUang.id_member}.`)},async updateDepositBalance(s){try{const t=`/updatedepositbalanceuang/${this.FormTransactionUang.id_member}`,i=await this.$http.put(t,{total_deposit:s});g.success(i.data.message)}catch{g.warning("gagal update")}},async getPromo(){const s=await this.$http.get("/promo");this.promos=s.data.promo},availablePromo(){let s=this.promos,t=null;return s=s.filter(i=>i.jenis_promo==="promo_paket"),s.forEach(i=>{i.minimal_deposit<=this.FormTransactionUang.nominal_deposit_kelas&&(t===null||i.minimal_deposit>t.minimal_deposit)&&(t=i)}),t},getDataPegawai(){let s=localStorage.getItem("pegawaiData");return JSON.parse(s)},updateTotalBiayaUang(){const s=this.allKelas.find(t=>t.id_kelas===this.FormTransactionUang.id_kelas);if(s){const t=s.harga_kelas,i=this.FormTransactionUang.nominal_deposit_kelas,_=t*i;this.FormTransactionUang.nominal_uang=_}}},watch:{"FormTransactionUang.nominal_deposit_kelas":function(){this.updateTotalBiayaUang()},"FormTransactionUang.id_kelas":function(){this.updateTotalBiayaUang()}},mounted(){this.generateTransactionData(),this.getPromo(),this.getAllMember(),this.getAllKelas()}}),o=s=>(j("data-v-d6dd3712"),s=s(),I(),s),A={class:"content text-white p-5 mb-5"},R={class:"w-100 p-2 ml-auto"},V={class:"form-custom text-dark p-4 mb-3"},L=o(()=>a("p",null,[a("strong",null,"Daftar Promo :")],-1)),H={key:0},q={key:1},G={class:"container-fluid form-custom p-4 text-dark",ref:"sectionForm"},J=o(()=>a("div",{class:"d-flex justify-content-between"},[a("h3",{class:"title"},[N("Transaksi Deposit Paket Kelas"),a("span",{class:"mdi mdi-cash-multiple ms-2"})])],-1)),E=o(()=>a("hr",null,null,-1)),O={class:"mb-3"},Q=o(()=>a("label",{for:"no-transaksi",class:"form-label"},"No Struk",-1)),z=o(()=>a("div",{class:"mb-3"},[a("label",{for:"jenis-transaksi",class:"form-label"},"Jenis Transaksi"),a("input",{type:"text",value:"transaksi-deposit-paket",class:"form-control",id:"jenis-transaksi",disabled:""})],-1)),Y={class:"mb-3"},W=o(()=>a("label",{for:"exampleDataList",class:"form-label"},"ID Member",-1)),X={id:"datalistOptions"},Z=["value"],x={class:"mb-3"},aa=o(()=>a("label",{for:"pilihan-kelas",class:"form-label"},"Pilihan Kelas",-1)),sa=["value"],ta={class:"mb-3"},ea=o(()=>a("label",{for:"total-kelas",class:"form-label"},"Total Kelas",-1)),na={class:"mb-3"},oa=o(()=>a("label",{for:"total-kelas",class:"form-label"},"Total Biaya Uang",-1)),ia={class:"mb-3"},la=o(()=>a("label",{for:"promo",class:"form-label"},"Promo",-1)),ra=o(()=>a("option",{value:"null"},"Default Value",-1)),da=["value"],ma={id:"promoHelp",class:"form-text"},pa={class:"mb-3"},ua=o(()=>a("label",{for:"total-kelas",class:"form-label"},"Total Kelas + Bonus Promo",-1)),_a={key:0,class:"bg-danger text-white p-2 rounded mb-2"},ca={key:1,class:"bg-success text-white p-2 rounded mb-2"},ka=o(()=>a("div",{class:"d-flex justify-content-between"},[a("button",{type:"submit",class:"btn btn-primary"},"Submit")],-1)),ga=o(()=>a("hr",null,null,-1)),ha={class:"container-fluid form-custom p-4 text-dark mt-5",ref:"sectionTable"},ba={class:"bg light"},fa={width:"600px",id:"pdfContent2",style:{display:"none",margin:"500px"},class:"text-dark"},Ta={width:"600px",class:"p-1"},ya={class:"border border-dark"},Ua=o(()=>a("td",{style:{width:"50%"}},[a("strong",null,"Gofit")],-1)),Fa=o(()=>a("td",null,[a("p",null,"Jl Centralpark No 10 Yogyakarta")],-1)),va=o(()=>a("tr",null,null,-1)),wa={style:{width:"80%"}},Ka=o(()=>a("td",null,[a("strong",null,"Member")],-1)),Da=o(()=>a("td",null,":",-1)),$a=o(()=>a("td",null,":",-1)),Ma=o(()=>a("td",null,"Jenis Kelas",-1)),Ba=o(()=>a("td",null,":",-1)),Sa=o(()=>a("td",null,":",-1)),Pa=o(()=>a("td",null,"Masa Berlaku",-1)),ja=o(()=>a("td",null,":",-1)),Ia=o(()=>a("td",null,null,-1));function Na(s,t,i,_,b,Ca){const F=f("home-navbar"),v=f("back-button");return l(),r(p,null,[a("header",null,[T(F,{message:"Gofit - Transaksi Deposit Paket Kelas"})]),a("main",null,[a("div",A,[a("div",R,[T(v,{className:"btn btn-dark "})]),a("div",V,[L,a("ul",null,[(l(!0),r(p,null,c(s.promos,(e,m)=>(l(),r("li",{key:m},[e.jenis_promo=="promo_paket"?(l(),r("p",H,n(e.nama_promo)+" Manfaat : Bonus Kelas "+n(e.bonus_promo)+" dan tambahan masa berlaku lebih ++ , syarat minimal deposit : "+n(e.minimal_deposit)+" sesi kelas",1)):k("",!0),e.jenis_promo=="promo_reguler"?(l(),r("p",q,n(e.nama_promo)+" Manfaat : Bonus Deposit Rp "+n(e.bonus_promo)+" , Syarat minimal deposit Rp : "+n(e.minimal_deposit),1)):k("",!0)]))),128))])]),a("div",G,[J,E,a("form",{onSubmit:t[10]||(t[10]=D(e=>s.submitForm(e),["prevent"]))},[a("div",O,[Q,d(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.FormTransactionUang.NoStruk=e),class:"form-control",id:"no-transaksi",disabled:""},null,512),[[u,s.FormTransactionUang.NoStruk]])]),z,a("div",Y,[W,d(a("input",{class:"form-control",list:"datalistOptions",id:"exampleDataList","onUpdate:modelValue":t[1]||(t[1]=e=>s.FormTransactionUang.id_member=e),onInput:t[2]||(t[2]=(...e)=>s.afterInputKelas&&s.afterInputKelas(...e)),placeholder:"Ketik untuk mencari id member"},null,544),[[u,s.FormTransactionUang.id_member]]),a("datalist",X,[(l(!0),r(p,null,c(s.allMember,(e,m)=>(l(),r("option",{key:m,value:e.id_member},n(e.id_member),9,Z))),128))])]),a("div",x,[aa,d(a("select",{id:"pilihan-kelas","onUpdate:modelValue":t[3]||(t[3]=e=>s.FormTransactionUang.id_kelas=e),onChange:t[4]||(t[4]=(...e)=>s.updateAfterInputKelas&&s.updateAfterInputKelas(...e)),class:"form-select"},[(l(!0),r(p,null,c(s.allKelas,(e,m)=>(l(),r("option",{key:m,value:e.id_kelas},n(e.jenis_kelas),9,sa))),128))],544),[[y,s.FormTransactionUang.id_kelas]])]),d(a("div",{class:"bg-danger text-white p-2 rounded"},n(s.satuanKelasMessage),513),[[$,s.FormTransactionUang.id_kelas]]),a("div",ta,[ea,d(a("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>s.FormTransactionUang.nominal_deposit_kelas=e),onInput:t[6]||(t[6]=(...e)=>s.updateAfterInputQuantity&&s.updateAfterInputQuantity(...e)),class:"form-control",id:"total-kelas"},null,544),[[u,s.FormTransactionUang.nominal_deposit_kelas]])]),a("div",na,[oa,d(a("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>s.FormTransactionUang.nominal_uang=e),class:"form-control",id:"total-kelas",disabled:""},null,512),[[u,s.FormTransactionUang.nominal_uang]])]),a("div",ia,[la,d(a("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>s.FormTransactionUang.id_promo=e),class:"form-select",disabled:""},[ra,(l(!0),r(p,null,c(s.promos,(e,m)=>(l(),r("option",{key:m,value:e.id_promo},n(e.nama_promo),9,da))),128))],512),[[y,s.FormTransactionUang.id_promo]]),a("div",ma,n(s.PromoMessage),1)]),a("div",pa,[ua,d(a("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=e=>s.FormTransactionUang.nominal_deposit_kelas_send=e),class:"form-control",id:"total-kelas",disabled:""},null,512),[[u,s.FormTransactionUang.nominal_deposit_kelas_send]])]),s.FormTransactionUang.nominal_deposit_kelas==s.FormTransactionUang.nominal_deposit_kelas_send?(l(),r("div",_a,n(s.summaryMessage),1)):k("",!0),s.FormTransactionUang.nominal_deposit_kelas!=s.FormTransactionUang.nominal_deposit_kelas_send?(l(),r("div",ca,n(s.summaryMessage),1)):k("",!0),ka],32),ga],512),a("div",null,[a("div",ha,null,512)])])]),a("div",ba,[a("div",fa,[a("div",Ta,[a("table",ya,[a("tr",null,[Ua,a("td",null," No Struk : "+n(s.hasilTransaksi.transaksi_deposit_paket.no_struk),1)]),Fa,a("td",null,"Tanggal : "+n(new Date(s.hasilTransaksi.transaksi_deposit_paket.tanggal_deposit).toLocaleDateString("en-GB")),1),va,a("tr",null,[a("td",null,[a("table",null,[a("tr",wa,[Ka,Da,a("td",null,n(s.hasilTransaksi.member.id_member)+"/"+n(s.hasilTransaksi.member.nama_member),1)]),a("tr",null,[a("td",null,"Deposit(nominal deposit "+n(s.hasilTransaksi.transaksi_deposit_paket.nominal_deposit_kelas)+" gratis "+n(s.FormTransactionUang.nominal_deposit_kelas_send-s.hasilTransaksi.transaksi_deposit_paket.nominal_deposit_kelas)+")",1),$a,a("td",null,"Rp."+n(s.hasilTransaksi.transaksi_deposit_paket.nominal_uang),1)]),a("tr",null,[Ma,Ba,a("td",null,n(s.hasilTransaksi.kelas.jenis_kelas),1)]),a("tr",null,[a("td",null,"Total Deposit "+n(s.hasilTransaksi.kelas.jenis_kelas),1),Sa,a("td",null,n(s.FormTransactionUang.nominal_deposit_kelas_send),1)]),a("tr",null,[Pa,ja,a("td",null,n(new Date(s.hasilTransaksi.transaksi_deposit_paket.tanggal_kadeluarsa).toLocaleDateString("en-GB")),1)])])])]),a("tr",null,[Ia,a("td",null,"Kasir : "+n(s.getDataPegawai().id_pegawai)+"/"+n(s.getDataPegawai().nama_pegawai),1)])])])])])],64)}const Ja=w(C,[["render",Na],["__scopeId","data-v-d6dd3712"]]);export{Ja as default};
