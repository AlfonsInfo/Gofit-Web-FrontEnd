import{_ as w,d as A,r as f,o as r,c as o,a as t,b as p,F as b,q as y,t as i,k as g,H as C,B as S,u as B,g as h,S as T,$ as d,E as K,p as I,n as P}from"./index-b7f4b6dc.js";import"https://code.jquery.com/jquery-3.5.1.js";import"https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js";import"https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js";import"https://code.highcharts.com/highcharts.js";function M(a,s){$(document).ready(function(){$(a+" thead tr").clone(!0).addClass("filters").appendTo(a+" thead"),$(a).DataTable({orderCellsTop:!0,fixedHeader:!0,initComplete:function(){let l=this.api();l.columns(s).eq(0).each(function(u){let _=$(".filters th").eq($(l.column(u).header()).index()),v=$(_).text();$(_).html('<input type="text" placeholder="'+v+'" />'),$("input",$(".filters th").eq($(l.column(u).header()).index())).off("keyup change").on("change",function(c){$(this).attr("title",$(this).val());let m="({search})";this.selectionStart,l.column(u).search(this.value!=""?m.replace("{search}","((("+this.value+")))"):"",this.value!="",this.value=="").draw()}).on("keyup",function(c){c.stopPropagation(),$(this).trigger("change"),$(this).focus()[0].setSelectionRange(cursorPosition,cursorPosition)})})}})})}const N=A({components:{HomeNavbar:C,BackButton:S},data(){return{router:B(),inActiveMember:h([]),ActiveMember:h([]),countInit:0,NoStruk:"",Kadeluarsa:new Date,selectedMember:h([]),pegawaiPIC:"",tanggalTransaksi:new Date,hasilTransaksi:h({transaksi_aktivasi:{no_struk:""},transaksi_member:{}}),currentDate:""}},methods:{async confirmTransaction(a){this.generateTransactionData(a),(await T.fire({title:"Apakah Anda yakin melakukan konfirmasi transaksi aktivasi ? ",html:`
                <p>Detail Transaksi :</p>
                <ul>
                <p>ID Member: ${a.id_member}</p>
                <p>Jumlah Transaksi: Rp 3.000.000</p>
                <p>Tanggal Kadaluarsa: ${this.Kadeluarsa.getDate()} - ${this.Kadeluarsa.getMonth()+1} - ${this.Kadeluarsa.getFullYear()} </p>
                </ul>`,showCancelButton:!0,confirmButtonColor:"#28a745",confirmButtonText:"Lanjutkan",cancelButtonText:"Batal"})).isConfirmed&&this.ActivationTransaction()},async ActivationTransaction(){try{const a={id_pegawai:this.pegawaiPIC.id_pegawai,id_member:this.selectedMember.id_member},s=await this.$http.post("/transaksiaktivasi",a);this.updateExpiredMember(a),this.hasilTransaksi=s.data.data,this.generateStrukAktivasi(),d.success("Berhasil Konfirmasi Aktivasi"),this.getAllMember(),d.success(s.data.message),T.fire({title:"Transaksi Berhasil!",icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}catch{d.warning("Transaksi Gagal, Cek Data Transaksi !!")}},formatDateStruk(){this.tanggalTransaksi=new Date(this.hasilTransaksi.transaksi_aktivasi.tanggal_aktivasi),this.hasilTransaksi.transaksi_aktivasi.tanggal_aktivasi=this.tanggalTransaksi.toLocaleString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"})+" "+this.tanggalTransaksi.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}).replace(".",":")},async generateTransactionData(a){console.log(a);const s=new Date;this.selectedMember=a,a.tgl_kadeluarsa_aktivasi==null?(this.Kadeluarsa=new Date,this.Kadeluarsa.setFullYear(s.getFullYear()+1)):(this.Kadeluarsa=new Date(a.tgl_kadeluarsa_aktivasi),this.Kadeluarsa.setFullYear(this.Kadeluarsa.getFullYear()+1))},generateStrukAktivasi(){this.formatDateStruk(),window.jspPDF=window.jspdf.jsPDF;var a=document.querySelector("#pdfContent");a.style.display="block",a.style.fontSize="5px",a.style.lineHeight="1.2",a.style.margin="0",a.style.padding="0",new K({orientation:"l",unit:"mm",format:["300","100"]}).html(a,{callback:function(l){l.save("file.pdf"),a.style.display="none"},x:10,y:10})},async updateExpiredMember({id_member:a}){try{const s=await this.$http.get(`/updatememberexpired/${a}`);console.log("response",s.data.tgl_kadaluarsa),this.Kadeluarsa=s.data.tgl_kadaluarsa,d.success(s.data.message),console.log(this.kadeluarsa)}catch{console.error("Error Update Data Member")}},async getAllMember(a){const s=await this.$http.get("/member");this.inActiveMember=s.data.data.filter(l=>l.tgl_kadeluarsa_aktivasi==null||l.tgl_kadeluarsa_aktivasi>Date()),this.ActiveMember=s.data.data.filter(l=>l.tgl_kadeluarsa_aktivasi!=null||l.tgl_kadeluarsa_aktivasi<Date()),this.countInit==0&&(M("#table-active-member",[0,1,2]),M("#table-inactive-member",[0,1,2]),this.countInit++,d.success(a))},getDataPegawai(){let a=localStorage.getItem("pegawaiData");return JSON.parse(a)}},mounted(){this.getAllMember("Berhasil Mengambil Data Presensi"),this.pegawaiPIC=this.getDataPegawai()}}),e=a=>(I("data-v-02f691e2"),a=a(),P(),a),x=e(()=>t("div",{class:"text-dark table-custom mt-5 ms-5 me-5 p-2 d-inline-block"},null,-1)),F={class:"content bg-white text-dark table-custom m-5 mt-2"},L={class:"container-fluid p-4"},Y=e(()=>t("h3",null,"Tabel Member Tidak Aktif",-1)),q={id:"table-inactive-member",class:"#example table table-striped",style:{width:"100%"}},j=e(()=>t("thead",null,[t("tr",null,[t("th",null,"ID Member"),t("th",null,"Nama Member"),t("th",null,"No Telp Member"),t("th",null,"Tanggal Kadeluarsa"),t("th",null,"Aksi")])],-1)),E=["onClick"],H={class:"row"},R={class:"content bg-white text-dark table-custom m-5 mt-2"},G={class:"container-fluid p-4"},J=e(()=>t("h3",null,"Tabel Member Aktif",-1)),V={id:"table-active-member",class:"#example table table-striped filters",style:{width:"100%"}},z=e(()=>t("thead",null,[t("tr",null,[t("th",null,"ID Member"),t("th",null,"Nama Member"),t("th",null,"Tanggal Kadeluarsa"),t("th",null,"Aksi")])],-1)),O=["onClick"],U={class:"row"},Q={class:"modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},W={class:"modal-dialog"},X={class:"modal-content"},Z=e(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Aktivasi"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),tt={class:"modal-body"},at=e(()=>t("hr",null,null,-1)),et=e(()=>t("p",null,[t("strong",null," Transaksi : "),g(" transaksi-aktivasi")],-1)),st=e(()=>t("p",null,[t("strong",null," Nominal Transaksi : Rp "),g(" 3.000.000")],-1)),it=e(()=>t("strong",null," ID Member : ",-1)),lt={class:"modal-footer"},nt=e(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Batal",-1)),rt=e(()=>t("div",null,null,-1)),ot={class:"bg light"},dt={width:"600px",id:"pdfContent",style:{display:"none",margin:"500px"},class:"text-dark"},ut={width:"600px",class:"p-1"},ct={class:"border border-dark"},mt=e(()=>t("td",{style:{width:"70%"}},[t("strong",null,"Gofit"),t("p",null,"Jl Centralpark No 10 Yogyakarta")],-1)),ht=e(()=>t("td",null,null,-1)),_t=e(()=>t("tr",null,null,-1)),kt={style:{width:"80%"}},pt=e(()=>t("td",null,[t("strong",null,"Member")],-1)),bt=e(()=>t("td",null,":",-1)),gt=e(()=>t("tr",null,[t("td",null,"Aktivasi Tahunan"),t("td",null,":"),t("td",null,"Rp.3.000.0000,-")],-1)),vt=e(()=>t("td",null,"Masa Aktif Member",-1)),ft=e(()=>t("td",null,":",-1)),yt=e(()=>t("td",null,null,-1));function Tt(a,s,l,u,_,v){const c=f("home-navbar"),m=f("back-button");return r(),o(b,null,[t("header",null,[p(c,{message:"Gofit - Menu Transaksi Aktivasi"})]),t("main",null,[x,t("div",F,[t("div",L,[Y,t("table",q,[j,t("tbody",null,[(r(!0),o(b,null,y(a.inActiveMember,(n,k)=>(r(),o("tr",{key:k},[t("td",null,i(n.id_member),1),t("td",null,i(n.nama_member),1),t("td",null,i(n.no_telp_member),1),t("td",null,i(n.tgl_kadeluarsa_aktivasi?n.tgl_kadeluarsa_aktivasi:"Belum Pernah Aktivasi"),1),t("td",null,[t("button",{type:"button",class:"btn btn-success",onClick:D=>a.confirmTransaction(n)},"Aktivasi",8,E)])]))),128))])]),t("div",H,[p(m,{class:"col-md-3",className:"btn btn-dark"})])])]),t("div",R,[t("div",G,[J,t("table",V,[z,t("tbody",null,[(r(!0),o(b,null,y(a.ActiveMember,(n,k)=>(r(),o("tr",{key:k},[t("td",null,i(n.id_member),1),t("td",null,i(n.nama_member),1),t("td",null,i(n.tgl_kadeluarsa_aktivasi?n.tgl_kadeluarsa_aktivasi:"Belum Pernah Aktivasi"),1),t("td",null,[t("button",{onClick:D=>a.confirmTransaction(n),type:"button",class:"btn btn-primary"}," Perpanjang Aktivasi",8,O)])]))),128))])]),t("div",U,[p(m,{class:"col-md-3",className:"btn btn-dark"})])]),t("div",Q,[t("div",W,[t("div",X,[Z,t("div",tt,[t("h2",null,"No Struk : "+i(a.NoStruk),1),at,et,st,t("p",null,[it,g(" "+i(a.selectedMember.id_member)+"/"+i(a.selectedMember.nama_member),1)])]),t("div",lt,[nt,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:s[0]||(s[0]=n=>a.confirmTransaction(a.selectedMember))},"Konfirmasi Transaksi")])])])])]),rt]),t("div",ot,[t("div",dt,[t("div",ut,[t("table",ct,[t("tr",null,[mt,t("td",null,"No Struk : "+i(a.hasilTransaksi.transaksi_aktivasi.no_struk),1)]),t("tr",null,[ht,t("td",null,"Tanggal : "+i(a.hasilTransaksi.transaksi_aktivasi.tanggal_aktivasi),1)]),_t,t("tr",null,[t("td",null,[t("table",null,[t("tr",kt,[pt,bt,t("td",null,i(a.hasilTransaksi.transaksi_member.id_member),1)]),gt,t("tr",null,[vt,ft,t("td",null,i(` ${a.Kadeluarsa.getDate()}/${a.Kadeluarsa.getMonth()+1}/${a.Kadeluarsa.getFullYear()}`),1)])])])]),t("tr",null,[yt,t("td",null,"Kasir : "+i(a.pegawaiPIC.id_pegawai)+"/"+i(a.pegawaiPIC.nama_pegawai),1)])])])])])],64)}const Bt=w(N,[["render",Tt],["__scopeId","data-v-02f691e2"]]);export{Bt as default};
